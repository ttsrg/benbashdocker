---

#- name: Wait 300 seconds for target connection to become reachable/usable
#  wait_for:
#    timeout: 300

- name: Check if Docker is installed
  command: systemctl status docker
  register: docker_check
  ignore_errors: yes
  changed_when: False

- name: Check if ---===docker info===----   is working
  command: docker info
  register: docker_info
  ignore_errors: yes
  changed_when: False
                
#- name: add user to group docker -force
#  command:  sg docker
#  changed_when: False
##  when: docker_info.stderr.find('permission denied') != -1
#  when: docker_info.rc == 1
    
#stat /var/run/docker.sock
#ps aux | grep dockerd
# id

- name: Create a network
  docker_network:
    name: gerrit-net
#  become: yes
  
- name: create volume
  docker_volume:
    name: ben_postgre_sql

- name: create volume
  docker_volume:
    name: ben_postgre_etc
    

- name: create volume
  docker_volume:
    name: ben_postgre_log

- name: Create a data container
  docker_container:
    name: benpostgre
    image: ttserg/postgre:10
    state: started
    networks:
      - name: gerrit-net
#    ports:
#      - "5432:5432"
    volumes:
    - ben_postgre_sql:/var/lib/postgresql
    - ben_postgre_etc:/etc/postgresql
    - ben_postgre_log:/var/log/postgresql
    restart_policy:  always